function getModule(){var a=document.form1.module;for(i=0;i<butt.length;i++){a[i]=new Option(butt[i]["modulename"],butt[i]["modulename"])}}function setModule(b){var a=document.form1.module;a.value=b;getKpiname()}function getKpiname(){var e=document.form1.kpiname;var c=0;var a=document.form1.module.selectedIndex;var b=butt[a]["kpis"];for(var1 in b){var d=b[var1];e[c]=new Option(d["kpi_name"],d["kpi_name"]);c++}e.length=c;getViewname()}function setKpiname(a,c){setModule(a);var b=document.form1.kpiname;b.value=c;getViewname()}function getViewname(){var g=document.form1.viewname;var f=document.form1.kpiname;var b=f.selectedIndex;var a=document.form1.module.selectedIndex;var d=butt[a]["kpis"][b]["views"];var c=0;for(var1 in d){var e=d[var1];g[c]=new Option(e["view_name"],e["view_name"]);c++}g[c]=new Option("total(average)","total");g.value="total";c++;g.length=c;getViews()}function getViews(){var h=document.form1.views;var g=document.form1.kpiname;var f=document.form1.viewname;var c=g.selectedIndex;var b=f.selectedIndex;var a=document.form1.module.selectedIndex;if(b==f.length-1){h.length=1;return}var e=butt[a]["kpis"][c]["views"][b]["dims"];var d=1;for(var1 in e){h[d]=new Option(var1,var1);d++}h.length=d}function getFineness(){var g=new Array();g[0]={"five minutes":"1","ten minutes":"2","thirty minute":"6","one hour":"12"};g[1]={"one hour":"1","two hour":"2","six hour":"6","tweleve hour":"12"};g[2]={"one day":"1"};g[3]={"one day":"1","a month":"30"};setOptions("fineness",0,g);var h=document.getElementById("width");var f=h.selectedIndex;var e=document.getElementById("date2");var c=document.getElementById("fine");if(f<4){setOptions("fineness",f,g);e.style.display="none";e.style["float"]="left"}else{var d=new Date(document.form1.begindate.value);var b=new Date(document.form1.enddate.value);if(d==null||d==null){alert("日期不合法，请重新输入!")}var a=b.getTime()-d.getTime();a/=24*3600*1000;if(a<2){setOptions("fineness",0,g)}else{if(a<7){setOptions("fineness",1,g)}else{setOptions("fineness",2,g)}}c.style["float"]="right";e.style.display="block"}}function setOptions(a,b,d){var f=document.getElementById(a);f.length=0;var e=d[b];for(var c in e){f.appendChild(new Option(c,e[c]))}}function getKpiValue(h,f,e,j,g){if(g=="total"){return getJsonValue(h,f,"kpi_total")}else{return getJsonValue(h,f,"views",e,"dims",j)}}function getdims(e,d,c){if(e==null){return null}if(e[d]==null){return null}if(e[d]["views"][c]==null){return null}return e[d]["views"][c]["dims"]}function getJsonValue(){var b=arguments[0];for(var a=1;a<arguments.length;a++){if(b==null){return null}b=b[arguments[a]]}return b}function getTable(j,l){var h=document.getElementById(j);var a=h.insertRow(1);var c=0;for(var g in l[0]){var e=a.insertCell(c);if(g=="x"){g="time"}e.innerHTML=abc;c++}for(var d=0;d<l.length;d++){var a=h.insertRow(h.rows.length);var c=0;for(var g in l[0]){var e=a.insertCell(c);if(g=="x"){var b=new Date(l[d][g]);e.innerHTML=b.toLocaleString()}else{var f=l[d][g];if(f==undefined){f="-"}e.innerHTML=f}c++}}}function getData(){var r=document.form1.kpiname.selectedIndex;var q=document.form1.viewname.selectedIndex;var o=document.form1.viewname.value;var p=document.form1.views.value;var w=new Array();if(o!="total"&&p=="all"){for(m=1;m<document.form1.views.length;m++){myykey[m-1]=document.form1.views[m].text;total[myykey[m-1]]=0}}else{myykey[0]="this "+suffix;myykey[1]="last "+suffix;total[myykey[0]]=0;total[myykey[1]]=0}var m=0;if(document.form1.width.value=="o"){var v=new Date(document.form1.begindate.value);var n=v.getTime()-3600*8*1000;var u=new Date(document.form1.enddate.value);var l=u.getTime()-3600*8*1000;var g=new Array();for(var h=0,f=0;f<str1.length;f++){var e=str1[f]["time"]*1000;if(e>=n&&e<=l){g[h]=str1[f];h++}}str1=g}for(;m<str1.length&&m<str2.length;m++){mydata[m]=new Object();mydata[m].x=str1[m]["time"]*1000;kpis1=str1[m]["kpis"];kpis2=str2[m]["kpis"];var t=getJsonValue(kpis1,r,"views",q,"dims");if(o!="total"&&p=="all"){for(view1 in t){mydata[m][view1]=getKpiValue(kpis1,r,q,view1,o);total[view1]=total[view1]+mydata[m][view1];w[view1]=mydata[m][view1]}}else{mydata[m][myykey[0]]=getKpiValue(kpis1,r,q,p,o);mydata[m][myykey[1]]=getKpiValue(kpis2,r,q,p,o);total[myykey[0]]=total[myykey[0]]+mydata[m][myykey[0]];total[myykey[1]]=total[myykey[1]]+mydata[m][myykey[1]];w[myykey[0]]=mydata[m][myykey[0]];w[myykey[1]]=mydata[m][myykey[1]]}}for(;m<str1.length;m++){var v=new Date(str1[m]["time"]*1000);var u=new Date(document.form1.begindate.value);mydata[m]=new Object();mydata[m].x=str1[m]["time"]*1000;kpis1=str1[m]["kpis"];var t=new Object();for(s=1;s<document.form1.views.length;s++){t[document.form1.views[s].text]=0}if(o!="total"&&p=="all"){for(view1 in t){mydata[m][view1]=getKpiValue(kpis1,r,q,view1,o);total[view1]=total[view1]+mydata[m][view1];w[view1]=mydata[m][view1]}}else{mydata[m][myykey[0]]=getKpiValue(kpis1,r,q,p,o);total[myykey[0]]=total[myykey[0]]+mydata[m][myykey[0]];w[myykey[0]]=mydata[m][myykey[0]]}}if(o=="total"||p!="all"){for(;m<str2.length;m++){mydata[m]=new Object();mydata[m].x=mydata[m-1].x+interval;kpis2=str2[m]["kpis"];var t=getdims(kpis2,r,q);mydata[m][myykey[1]]=getKpiValue(kpis2,r,q,p,o);total[myykey[1]]=total[myykey[1]]+mydata[m][myykey[1]];w[myykey[1]]=mydata[m][myykey[1]]}}if(str1[0]["kpis"][r]["kpi_op"]!=null){total=w}}function getObject(a){if(document.getElementById&&document.getElementById(a)){return document.getElementById(a)}else{if(document.all&&document.all(a)){return document.all(a)}else{if(document.layers&&document.layers[a]){return document.layers[a]}else{return false}}}}function showHide(b,c){var a=getObject(c);if(a.style.display=="none"){a.style.display="block";b.className="xias"}else{a.style.display="none";b.className="rights"}}function setLayout(c){var b=document.getElementById("default");b.innerHTML=c;changeLayout()}function changeLayout(){var d=["div2","div3","graph","chart","maingraph"];var b=document.getElementById("default");var e=document.form1.layout;if(b.innerHTML=="mainpage"){for(var c=0;c<d.length-1;c++){document.getElementById(d[c]).style.display="none"}document.getElementById(d[d.length-1]).style.display="block";b.innerHTML="more";e.value="mainpage"}else{for(var c=0;c<d.length-1;c++){document.getElementById(d[c]).style.display="block"}document.getElementById(d[d.length-1]).style.display="none";b.innerHTML="mainpage";e.value="more"}$(function(){var a;var f=document.getElementById("maingraph");if(f.style.display=="none"){a=$("#chart").height()+700}else{a=$("#maingraph").height()}$("#div0").height(a)})}function getMenu(b,j){var h=document.getElementById(j);var e=document.createElement("ul");var k=document.createElement("li");var g=document.createElement("a");g.setAttribute("href","#");g.setAttribute("onclick","changeLayout()");g.innerHTML="more";g.id="default";k.appendChild(g);e.appendChild(k);br=document.createElement("br");e.appendChild(br);for(i=0;i<butt.length;i++){var c=b[i]["modulename"];var d=c+"1";var k=document.createElement("li");var g=document.createElement("a");g.setAttribute("href","#");g.setAttribute("onclick","showHide(this,this.id+'abc');setModule(this.id)");g.id=c;g.innerHTML=c;k.appendChild(g);var f=getSubMenu(b,c,i);f.id=c+"abc";f.setAttribute("style","display:none;");k.appendChild(f);e.appendChild(k)}h.appendChild(e)}function getSubMenu(b,c,d){var j=document.getElementById(c);var f=document.createElement("ul");var e=b[d]["kpis"];for(var1 in e){var g=e[var1]["kpi_name"];var k=document.createElement("li");var h=document.createElement("a");h.setAttribute("href","#");h.setAttribute("onclick","setLayout('more');setKpiname(this.module,this.id);formSubmit('form1')");h.id=g;h.module=c;h.innerHTML=g;k.appendChild(h);f.appendChild(k)}return f}function formSubmit(b){var a=document.getElementById(b);a.submit()};
